import{u}from"./useQuery-D_0ZzEPi.js";import{a as m,G as f,J as h,r as d,s as c}from"./index-Ba-_IHuQ.js";const y=async()=>{const{data:e,error:s}=await c.from("property_types").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(s)throw console.error("Supabase error fetching property types:",s.message),new Error(s.message);return console.log("Fetched property types:",e),e||[]},v=()=>{const{currentLanguage:e}=m(),{toast:s}=f(),t=h(),{data:a,isLoading:r,isError:i,error:n}=u({queryKey:["propertyTypes"],queryFn:y,staleTime:5*60*1e3});return d.useEffect(()=>{i&&s({title:e==="ar"?"خطأ":"Error",description:`${e==="ar"?"فشل في تحميل أنواع العقارات":"Failed to load property types"}: ${n==null?void 0:n.message}`,variant:"destructive"})},[i,n,e,s]),d.useEffect(()=>{const o=c.channel("property_types_changes").on("postgres_changes",{event:"*",schema:"public",table:"property_types"},_=>{console.log("Property types changed, invalidating query.",_),t.invalidateQueries({queryKey:["propertyTypes"]})}).subscribe();return()=>{c.removeChannel(o)}},[t]),{propertyTypes:a??[],loading:r,isError:i}},w=(e,s="en")=>{let t=e.title;s==="ar"&&e.title_ar?t=e.title_ar:s==="tr"&&e.title_tr?t=e.title_tr:s==="en"&&e.title_en&&(t=e.title_en);let a="/placeholder.svg";return e.cover_image?a=e.cover_image:e.images&&Array.isArray(e.images)&&e.images.length>0&&(a=e.images[0]),{id:e.id,title:t,location:`${e.city}${e.district?`, ${e.district}`:""}`,city:e.city,district:e.district||"",price:e.price,currency:e.currency||"EUR",deposit:e.deposit||0,commission:e.commission||0,beds:e.bedrooms||0,baths:e.bathrooms||0,area:e.area||0,image:a,featured:e.is_featured||!1,is_featured:e.is_featured||!1,rating:4.5,type:e.property_type,listing_type:e.listing_type,images:Array.isArray(e.images)?e.images:[],is_student_housing:e.is_student_housing||!1,student_housing_gender:e.student_housing_gender,status:e.status,hidden_by_admin:e.hidden_by_admin,created_at:e.created_at}},l=(e,s)=>{if(!e)return"";switch(s){case"ar":return e.name_ar;case"tr":return e.name_tr;default:return e.name_en}},E=(e,s,t,a)=>{if(!e)return"";if(e.property_types)return l(e.property_types,t);if(a)return t==="ar"?"جار التحميل...":t==="tr"?"Yükleniyor...":"Loading...";if(e.property_type_id&&s.length>0){const r=s.find(i=>i.id===e.property_type_id);if(r)return l(r,t)}switch((e.property_type||"").toLowerCase()){case"apartment":return t==="ar"?"شقة":t==="tr"?"Daire":"Apartment";case"villa":return t==="ar"?"فيلا":"Villa";case"studio":return t==="ar"?"استوديو":t==="tr"?"Stüdyo":"Studio";case"house":return t==="ar"?"بيت":t==="tr"?"Ev":"House";default:return e.property_type?e.property_type:t==="ar"?"غير محدد":t==="tr"?"Belirtilmemiş":"Not Specified"}},C=(e,s)=>{switch(s){case"ar":return e.name_ar;case"tr":return e.name_tr;default:return e.name_en}},q=(e,s)=>{switch(s){case"ar":return e.name_ar;case"tr":return e.name_tr;default:return e.name_en}},P=(e,s)=>s.filter(t=>t.city_id===e);export{P as a,q as b,l as c,E as d,C as g,w as t,v as u};
