import{u,r as i,j as t,ah as f,s as g}from"./index-Ba-_IHuQ.js";const x=({children:m})=>{const{user:e,loading:a}=u(),[c,r]=i.useState(null),[l,o]=i.useState(!0);return i.useEffect(()=>{a||(async()=>{if(!e){r(!1),o(!1);return}try{if(console.log("ProtectedAdminRoute: Checking admin status for:",e.email),e.email==="omar122540@gmail.com"){console.log("ProtectedAdminRoute: Primary admin detected"),r(!0),o(!1);return}const{data:s,error:n}=await g.from("admin_management").select("*").eq("admin_email",e.email).eq("is_active",!0).single();if(console.log("ProtectedAdminRoute: Admin management query result:",{data:s,error:n}),n&&n.code!=="PGRST116")console.error("ProtectedAdminRoute: Error checking admin status:",n),r(!1);else{const d=!!s;console.log("ProtectedAdminRoute: Admin status determined:",d),r(d)}}catch(s){console.error("ProtectedAdminRoute: Error in admin check:",s),r(!1)}o(!1)})()},[e,a]),a||l?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),t.jsx("p",{className:"mt-2 text-gray-600",children:"التحقق من الصلاحيات..."})]})}):!e||!c?(console.log("ProtectedAdminRoute: Redirecting to login. User:",!!e,"IsAdmin:",c),t.jsx(f,{to:"/login",replace:!0})):t.jsx(t.Fragment,{children:m})};export{x as default};
