import{a as M,G as J,r as S,s as j,j as e,I as w,C as Q,H as Z}from"./index-Ba-_IHuQ.js";import{D as G,f as ee,a as W,b as V,c as K}from"./dialog-Bi8CA0Hs.js";import{S as F,a as P,b as Y,c as $,d as I}from"./select-B0LLBn5t.js";import{T as C}from"./textarea-D6kC44b6.js";import{L as v}from"./label-3yzes-iA.js";import{T as te,a as se,b as O,c as U}from"./tabs-3zOAl0ep.js";import{B as L}from"./ban-DH3c8ygT.js";import{C as re}from"./clock-Fq3ibpDw.js";import{B as ne}from"./badge-DRGEcZbO.js";import{S as ae}from"./scroll-area-C94vp1UI.js";import{S as oe}from"./separator-wDokUAnQ.js";import{b as ie,A as le,D as ce,a as de,t as ue}from"./seedUserActivity-CcC_9Fqw.js";import{R as B}from"./refresh-cw-Dzle1iAu.js";import{E as pe,a as _e}from"./eye-off-QLdkjG-i.js";import{T as me}from"./trash-2-D9yzkGdt.js";import{S as he}from"./square-pen-XvOR2TU8.js";import{t as y,c as ye,e as q,g as H,m as X,a as D,b as fe}from"./en-US-ZBLZOCkG.js";function R(r,i){const o=y(r),d=y(i),t=o.getTime()-d.getTime();return t<0?-1:t>0?1:t}function ge(r){return ye(r,Date.now())}function Ee(r,i){const o=y(r),d=y(i),t=o.getFullYear()-d.getFullYear(),_=o.getMonth()-d.getMonth();return t*12+_}function xe(r){return i=>{const d=(r?Math[r]:Math.trunc)(i);return d===0?0:d}}function Se(r,i){return+y(r)-+y(i)}function Te(r){const i=y(r);return i.setHours(23,59,59,999),i}function Ne(r){const i=y(r),o=i.getMonth();return i.setFullYear(i.getFullYear(),o+1,0),i.setHours(23,59,59,999),i}function Ae(r){const i=y(r);return+Te(i)==+Ne(i)}function je(r,i){const o=y(r),d=y(i),t=R(o,d),_=Math.abs(Ee(o,d));let f;if(_<1)f=0;else{o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-t*_);let c=R(o,d)===-t;Ae(y(r))&&_===1&&R(r,d)===1&&(c=!1),f=t*(_-Number(c))}return f===0?0:f}function ve(r,i,o){const d=Se(r,i)/1e3;return xe(o==null?void 0:o.roundingMethod)(d)}function we(r,i,o){const d=fe(),t=(o==null?void 0:o.locale)??d.locale??q,_=2520,f=R(r,i);if(isNaN(f))throw new RangeError("Invalid time value");const c=Object.assign({},o,{addSuffix:o==null?void 0:o.addSuffix,comparison:f});let a,p;f>0?(a=y(i),p=y(r)):(a=y(r),p=y(i));const n=ve(p,a),T=(H(p)-H(a))/1e3,u=Math.round((n-T)/60);let E;if(u<2)return o!=null&&o.includeSeconds?n<5?t.formatDistance("lessThanXSeconds",5,c):n<10?t.formatDistance("lessThanXSeconds",10,c):n<20?t.formatDistance("lessThanXSeconds",20,c):n<40?t.formatDistance("halfAMinute",0,c):n<60?t.formatDistance("lessThanXMinutes",1,c):t.formatDistance("xMinutes",1,c):u===0?t.formatDistance("lessThanXMinutes",1,c):t.formatDistance("xMinutes",u,c);if(u<45)return t.formatDistance("xMinutes",u,c);if(u<90)return t.formatDistance("aboutXHours",1,c);if(u<X){const m=Math.round(u/60);return t.formatDistance("aboutXHours",m,c)}else{if(u<_)return t.formatDistance("xDays",1,c);if(u<D){const m=Math.round(u/X);return t.formatDistance("xDays",m,c)}else if(u<D*2)return E=Math.round(u/D),t.formatDistance("aboutXMonths",E,c)}if(E=je(p,a),E<12){const m=Math.round(u/D);return t.formatDistance("xMonths",m,c)}else{const m=E%12,h=Math.trunc(E/12);return m<3?t.formatDistance("aboutXYears",h,c):m<9?t.formatDistance("overXYears",h,c):t.formatDistance("almostXYears",h+1,c)}}function be(r,i){return we(r,ge(r),i)}const De=()=>{const{currentLanguage:r}=M(),{toast:i}=J(),[o,d]=S.useState(!1),t=async(c,a,p,n)=>{var T;d(!0);try{const u=a==="temporary"&&p?f(p):null,m=(T=(await j.auth.getUser()).data.user)==null?void 0:T.id;console.log("=== SUSPENSION DEBUG START ==="),console.log("userId:",c),console.log("suspensionType:",a),console.log("duration:",p),console.log("calculated suspensionEndDate:",u),console.log("is temporary?",a==="temporary"),console.log("=== SUSPENSION DEBUG END ===");const h={is_suspended:!0,suspension_reason:(n==null?void 0:n.en)||(n==null?void 0:n.ar)||(n==null?void 0:n.tr)||"",suspension_reason_ar:(n==null?void 0:n.ar)||"",suspension_reason_en:(n==null?void 0:n.en)||"",suspension_reason_tr:(n==null?void 0:n.tr)||"",suspended_by:m};a==="temporary"&&u?h.suspension_end_date=u:h.suspension_end_date=null,console.log("=== UPDATE DATA DEBUG ==="),console.log("Final update data:",JSON.stringify(h,null,2)),console.log("suspension_end_date value:",h.suspension_end_date),console.log("suspension_end_date type:",typeof h.suspension_end_date);const{error:A}=await j.from("profiles").update(h).eq("id",c);if(A)throw console.error("=== PROFILE UPDATE ERROR ==="),console.error("Error:",A),A;console.log("=== PROFILE UPDATE SUCCESS ==="),await new Promise(b=>setTimeout(b,500));const{data:s,error:l}=await j.from("profiles").select("id, is_suspended, suspension_end_date, suspension_reason, suspension_reason_ar, suspension_reason_en, suspension_reason_tr, suspended_by").eq("id",c).single();if(l)console.error("=== VERIFICATION ERROR ==="),console.error("Error:",l);else{console.log("=== VERIFICATION SUCCESS ==="),console.log("Saved data in database:",JSON.stringify(s,null,2)),console.log("suspension_end_date value:",s==null?void 0:s.suspension_end_date),console.log("suspension_end_date type:",typeof(s==null?void 0:s.suspension_end_date)),console.log("is_suspended:",s==null?void 0:s.is_suspended);const b=(s==null?void 0:s.suspension_end_date)!==null&&(s==null?void 0:s.suspension_end_date)!==void 0&&(s==null?void 0:s.suspension_end_date)!=="";console.log("Is actually temporary (based on saved data):",b)}const{error:N}=await j.from("suspension_history").insert({user_id:c,suspended_by:m,suspension_type:a,suspension_duration:p||null,suspension_end:u,reason:(n==null?void 0:n.en)||(n==null?void 0:n.ar)||(n==null?void 0:n.tr)||"",reason_ar:(n==null?void 0:n.ar)||"",reason_en:(n==null?void 0:n.en)||"",reason_tr:(n==null?void 0:n.tr)||""});if(N)throw console.error("=== HISTORY INSERT ERROR ==="),console.error("Error:",N),N;return console.log("=== SUSPENSION COMPLETED SUCCESSFULLY ==="),i({title:r==="ar"?"نجح":"Success",description:r==="ar"?`تم ${a==="permanent"?"حظر المستخدم نهائياً":"حظر المستخدم مؤقتاً"}`:`User ${a==="permanent"?"permanently":"temporarily"} suspended`}),{success:!0}}catch(u){return console.error("=== SUSPENSION ERROR ==="),console.error("Error:",u),i({title:r==="ar"?"خطأ":"Error",description:u.message||(r==="ar"?"فشل في حظر المستخدم":"Failed to suspend user"),variant:"destructive"}),{success:!1,error:u}}finally{d(!1)}},_=async c=>{d(!0);try{const{error:a}=await j.from("profiles").update({is_suspended:!1,suspension_end_date:null,suspension_reason:null,suspension_reason_ar:null,suspension_reason_en:null,suspension_reason_tr:null,suspended_by:null}).eq("id",c);if(a)throw a;return await j.from("suspension_history").update({is_active:!1}).eq("user_id",c).eq("is_active",!0),i({title:r==="ar"?"نجح":"Success",description:r==="ar"?"تم إلغاء حظر المستخدم":"User suspension removed"}),{success:!0}}catch(a){return i({title:r==="ar"?"خطأ":"Error",description:a.message||(r==="ar"?"فشل في إلغاء الحظر":"Failed to remove suspension"),variant:"destructive"}),{success:!1,error:a}}finally{d(!1)}},f=c=>{const a=new Date;switch(c){case"1_day":a.setDate(a.getDate()+1);break;case"1_week":a.setDate(a.getDate()+7);break;case"1_month":a.setMonth(a.getMonth()+1);break;case"3_months":a.setMonth(a.getMonth()+3);break;case"6_months":a.setMonth(a.getMonth()+6);break;case"1_year":a.setFullYear(a.getFullYear()+1);break;default:a.setDate(a.getDate()+1)}return a.toISOString()};return{suspendUser:t,unsuspendUser:_,loading:o}},Ke=({userId:r,userName:i,onSuspensionUpdated:o,trigger:d})=>{const{currentLanguage:t}=M(),{suspendUser:_,loading:f}=De(),[c,a]=S.useState(!1),[p,n]=S.useState("temporary"),[T,u]=S.useState("1_day"),[E,m]=S.useState(""),[h,A]=S.useState(""),[s,l]=S.useState(""),N=async()=>{const g={ar:E.trim(),en:h.trim(),tr:s.trim()};if(!g.ar&&!g.en&&!g.tr)return;(await _(r,p,T,g)).success&&(a(!1),m(""),A(""),l(""),o())},x={ar:{suspendUser:"حظر المستخدم",suspensionType:"نوع الحظر",temporary:"مؤقت",permanent:"دائم",duration:"مدة الحظر",reason:"سبب الحظر",reasonPlaceholder:"اكتب سبب الحظر...",confirm:"تأكيد الحظر",cancel:"إلغاء",suspending:"جارٍ الحظر...",reasonInArabic:"السبب بالعربية",reasonInEnglish:"السبب بالإنجليزية",reasonInTurkish:"السبب بالتركية",languages:"اللغات",durations:{"1_day":"يوم واحد","1_week":"أسبوع واحد","1_month":"شهر واحد","3_months":"ثلاثة أشهر","6_months":"ستة أشهر","1_year":"سنة واحدة"}},en:{suspendUser:"Suspend User",suspensionType:"Suspension Type",temporary:"Temporary",permanent:"Permanent",duration:"Suspension Duration",reason:"Suspension Reason",reasonPlaceholder:"Enter suspension reason...",confirm:"Confirm Suspension",cancel:"Cancel",suspending:"Suspending...",reasonInArabic:"Reason in Arabic",reasonInEnglish:"Reason in English",reasonInTurkish:"Reason in Turkish",languages:"Languages",durations:{"1_day":"One Day","1_week":"One Week","1_month":"One Month","3_months":"Three Months","6_months":"Six Months","1_year":"One Year"}},tr:{suspendUser:"Kullanıcıyı Askıya Al",suspensionType:"Askıya Alma Türü",temporary:"Geçici",permanent:"Kalıcı",duration:"Askıya Alma Süresi",reason:"Askıya Alma Nedeni",reasonPlaceholder:"Askıya alma nedenini girin...",confirm:"Askıya Almayı Onayla",cancel:"İptal",suspending:"Askıya Alınıyor...",reasonInArabic:"Arapça Neden",reasonInEnglish:"İngilizce Neden",reasonInTurkish:"Türkçe Neden",languages:"Diller",durations:{"1_day":"Bir Gün","1_week":"Bir Hafta","1_month":"Bir Ay","3_months":"Üç Ay","6_months":"Altı Ay","1_year":"Bir Yıl"}}}[t],z=E.trim()||h.trim()||s.trim();return e.jsxs(G,{open:c,onOpenChange:a,children:[e.jsx(ee,{asChild:!0,children:d||e.jsxs(w,{variant:"destructive",size:"sm",children:[e.jsx(L,{className:"w-3 h-3 mr-1"}),x.suspendUser]})}),e.jsxs(W,{className:"sm:max-w-2xl",children:[e.jsx(V,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-red-500"}),x.suspendUser,": ",i]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"suspensionType",children:x.suspensionType}),e.jsxs(F,{value:p,onValueChange:g=>n(g),children:[e.jsx(P,{children:e.jsx(Y,{})}),e.jsxs($,{children:[e.jsx(I,{value:"temporary",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),x.temporary]})}),e.jsx(I,{value:"permanent",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),x.permanent]})})]})]})]}),p==="temporary"&&e.jsxs("div",{children:[e.jsx(v,{htmlFor:"duration",children:x.duration}),e.jsxs(F,{value:T,onValueChange:u,children:[e.jsx(P,{children:e.jsx(Y,{})}),e.jsx($,{children:Object.entries(x.durations).map(([g,k])=>e.jsx(I,{value:g,children:k},g))})]})]}),e.jsxs("div",{children:[e.jsx(v,{children:x.reason}),e.jsxs(te,{defaultValue:"ar",className:"mt-2",children:[e.jsxs(se,{className:"grid w-full grid-cols-3",children:[e.jsx(O,{value:"ar",children:"العربية"}),e.jsx(O,{value:"en",children:"English"}),e.jsx(O,{value:"tr",children:"Türkçe"})]}),e.jsxs(U,{value:"ar",className:"mt-4",children:[e.jsx(v,{htmlFor:"reasonAr",children:x.reasonInArabic}),e.jsx(C,{id:"reasonAr",value:E,onChange:g=>m(g.target.value),placeholder:"اكتب سبب الحظر بالعربية...",className:"min-h-[80px] mt-2"})]}),e.jsxs(U,{value:"en",className:"mt-4",children:[e.jsx(v,{htmlFor:"reasonEn",children:x.reasonInEnglish}),e.jsx(C,{id:"reasonEn",value:h,onChange:g=>A(g.target.value),placeholder:"Enter suspension reason in English...",className:"min-h-[80px] mt-2"})]}),e.jsxs(U,{value:"tr",className:"mt-4",children:[e.jsx(v,{htmlFor:"reasonTr",children:x.reasonInTurkish}),e.jsx(C,{id:"reasonTr",value:s,onChange:g=>l(g.target.value),placeholder:"Askıya alma nedenini Türkçe girin...",className:"min-h-[80px] mt-2"})]})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(w,{variant:"outline",onClick:()=>a(!1),children:x.cancel}),e.jsx(w,{variant:"destructive",onClick:N,disabled:f||!z,children:f?x.suspending:x.confirm})]})]})]})]})},Re=async()=>{try{const{error:r}=await j.from("user_activity_logs").select("id").limit(1);return r&&r.message.includes("does not exist")?(console.log("Table does not exist, need to create it manually in Supabase dashboard"),{success:!1,error:"Table needs to be created manually in Supabase dashboard",instructions:`
          Please go to your Supabase dashboard and run this SQL:
          
          CREATE TABLE user_activity_logs (
            id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
            user_id UUID NOT NULL,
            action_type TEXT NOT NULL,
            action_details JSONB DEFAULT '{}',
            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
          );

          CREATE INDEX idx_user_activity_logs_user_id ON user_activity_logs(user_id);
          CREATE INDEX idx_user_activity_logs_created_at ON user_activity_logs(created_at DESC);
          CREATE INDEX idx_user_activity_logs_action_type ON user_activity_logs(action_type);

          ALTER TABLE user_activity_logs ENABLE ROW LEVEL SECURITY;

          CREATE POLICY "Users can view own activity logs" ON user_activity_logs
            FOR SELECT USING (auth.uid() = user_id);

          CREATE POLICY "Users can insert own activity logs" ON user_activity_logs
            FOR INSERT WITH CHECK (auth.uid() = user_id);

          CREATE POLICY "Admins can view all activity logs" ON user_activity_logs
            FOR SELECT USING (
              EXISTS (
                SELECT 1 FROM profiles 
                WHERE profiles.id = auth.uid() 
                AND profiles.user_type = 'admin'
              )
            );

          CREATE POLICY "Admins can insert activity logs for any user" ON user_activity_logs
            FOR INSERT WITH CHECK (
              EXISTS (
                SELECT 1 FROM profiles 
                WHERE profiles.id = auth.uid() 
                AND profiles.user_type = 'admin'
              )
            );
        `}):(console.log("Table already exists or accessible"),{success:!0})}catch(r){return console.error("Error checking table:",r),{success:!1,error:r}}},qe=({open:r,onOpenChange:i,userId:o,userName:d})=>{const{currentLanguage:t}=M(),[_,f]=S.useState([]),[c,a]=S.useState(!1);S.useEffect(()=>{r&&o&&p()},[r,o]);const p=async()=>{a(!0);try{const{data:s,error:l}=await j.from("user_activity_logs").select("*").eq("user_id",o).order("created_at",{ascending:!1}).limit(100);if(l){console.error("Error fetching user activities:",l);return}f(s||[])}catch(s){console.error("Unexpected error:",s)}finally{a(!1)}},n=async()=>{o&&d&&(await ie(o,d),await p())},T=async()=>{(await Re()).success?(alert(t==="ar"?"تم إنشاء الجدول بنجاح! يمكنك الآن إضافة الأنشطة.":"Table created successfully! You can now add activities."),await p()):alert(`
${t==="ar"?"يرجى إنشاء الجدول يدوياً في Supabase:":"Please create the table manually in Supabase:"}

1. ${t==="ar"?"اذهب إلى Supabase Dashboard":"Go to Supabase Dashboard"}
2. ${t==="ar"?"افتح SQL Editor":"Open SQL Editor"}
3. ${t==="ar"?"شغل هذا الكود:":"Run this code:"}

CREATE TABLE user_activity_logs (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL,
  action_type TEXT NOT NULL,
  action_details JSONB DEFAULT '{}',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_user_activity_logs_user_id ON user_activity_logs(user_id);
ALTER TABLE user_activity_logs ENABLE ROW LEVEL SECURITY;

-- Fix RLS policies
DROP POLICY IF EXISTS "Admins can view all activity logs" ON user_activity_logs;
DROP POLICY IF EXISTS "Admins can insert activity logs for any user" ON user_activity_logs;

CREATE POLICY "admin_select_all" ON user_activity_logs
  FOR SELECT USING (
    EXISTS (
      SELECT 1 FROM public.profiles
      WHERE profiles.id = auth.uid()
      AND profiles.user_type = 'admin'
    )
  );

CREATE POLICY "admin_insert_all" ON user_activity_logs
  FOR INSERT WITH CHECK (
    EXISTS (
      SELECT 1 FROM public.profiles
      WHERE profiles.id = auth.uid()
      AND profiles.user_type = 'admin'
    )
  );

${t==="ar"?"راجع ملف docs/CREATE_USER_ACTIVITY_TABLE.md للتفاصيل الكاملة":"See docs/CREATE_USER_ACTIVITY_TABLE.md for full details"}
      `)},u=s=>{switch(s){case"property_created":return e.jsx(Z,{className:"w-4 h-4"});case"property_updated":return e.jsx(he,{className:"w-4 h-4"});case"property_deleted":return e.jsx(me,{className:"w-4 h-4"});case"property_hidden":return e.jsx(_e,{className:"w-4 h-4"});case"property_shown":return e.jsx(pe,{className:"w-4 h-4"});case"property_sold":case"property_rented":return e.jsx(ce,{className:"w-4 h-4"});case"status_changed":return e.jsx(B,{className:"w-4 h-4"});default:return e.jsx(le,{className:"w-4 h-4"})}},E=s=>{switch(s){case"property_created":return"bg-green-100 text-green-800 border-green-200";case"property_updated":return"bg-blue-100 text-blue-800 border-blue-200";case"property_deleted":return"bg-red-100 text-red-800 border-red-200";case"property_hidden":return"bg-orange-100 text-orange-800 border-orange-200";case"property_shown":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"property_sold":case"property_rented":return"bg-purple-100 text-purple-800 border-purple-200";case"status_changed":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},m=s=>{if(t==="ar")switch(s){case"property_created":return"إنشاء عقار";case"property_updated":return"تحديث عقار";case"property_deleted":return"حذف عقار";case"property_hidden":return"إخفاء عقار";case"property_shown":return"إظهار عقار";case"property_sold":return"بيع عقار";case"property_rented":return"تأجير عقار";case"status_changed":return"تغيير حالة";default:return"نشاط"}else if(t==="tr")switch(s){case"property_created":return"Mülk Oluşturuldu";case"property_updated":return"Mülk Güncellendi";case"property_deleted":return"Mülk Silindi";case"property_hidden":return"Mülk Gizlendi";case"property_shown":return"Mülk Gösterildi";case"property_sold":return"Mülk Satıldı";case"property_rented":return"Mülk Kiralandı";case"status_changed":return"Durum Değişti";default:return"Etkinlik"}else switch(s){case"property_created":return"Property Created";case"property_updated":return"Property Updated";case"property_deleted":return"Property Deleted";case"property_hidden":return"Property Hidden";case"property_shown":return"Property Shown";case"property_sold":return"Property Sold";case"property_rented":return"Property Rented";case"status_changed":return"Status Changed";default:return"Activity"}},h=s=>{const l=new Date(s);return be(l,{addSuffix:!0,locale:t==="ar"?de:t==="tr"?ue:q})},A=s=>{const l=s.action_details||{};if(t==="ar")switch(s.action_type){case"property_created":return`تم إنشاء عقار جديد: ${l.property_title||"غير محدد"}`;case"property_updated":return`تم تحديث العقار: ${l.property_title||"غير محدد"}`;case"property_deleted":return`تم حذف العقار: ${l.property_title||"غير محدد"}`;case"property_hidden":return`تم إخفاء العقار: ${l.property_title||"غير محدد"}`;case"property_shown":return`تم إظهار العقار: ${l.property_title||"غير محدد"}`;case"property_sold":return`تم بيع العقار: ${l.property_title||"غير محدد"}`;case"property_rented":return`تم تأجير العقار: ${l.property_title||"غير محدد"}`;case"status_changed":return`تم تغيير حالة العقار: ${l.property_title||"غير محدد"} من ${l.old_status||""} إلى ${l.new_status||""}`;default:return l.property_title||"نشاط غير محدد"}else switch(s.action_type){case"property_created":return`Created property: ${l.property_title||"Unknown"}`;case"property_updated":return`Updated property: ${l.property_title||"Unknown"}`;case"property_deleted":return`Deleted property: ${l.property_title||"Unknown"}`;case"property_hidden":return`Hidden property: ${l.property_title||"Unknown"}`;case"property_shown":return`Shown property: ${l.property_title||"Unknown"}`;case"property_sold":return`Sold property: ${l.property_title||"Unknown"}`;case"property_rented":return`Rented property: ${l.property_title||"Unknown"}`;case"status_changed":return`Changed status of: ${l.property_title||"Unknown"} from ${l.old_status||""} to ${l.new_status||""}`;default:return l.property_title||"Unknown activity"}};return e.jsx(G,{open:r,onOpenChange:i,children:e.jsxs(W,{className:"max-w-4xl max-h-[80vh]",children:[e.jsx(V,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(K,{className:"flex items-center gap-3",children:[e.jsx(Q,{className:"w-5 h-5"}),t==="ar"?`سجل أنشطة ${d}`:t==="tr"?`${d} Etkinlik Günlüğü`:`${d}'s Activity Log`]}),_.length===0&&e.jsx(w,{onClick:n,variant:"outline",size:"sm",children:t==="ar"?"إضافة بيانات تجريبية":"Add Sample Data"})]})}),e.jsx(ae,{className:"h-[60vh] pr-4",children:c?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(B,{className:"w-6 h-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:t==="ar"?"جاري التحميل...":"Loading..."})]}):_.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"mb-4",children:t==="ar"?"لا توجد أنشطة مسجلة لهذا المستخدم":"No activities recorded for this user"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{onClick:T,variant:"outline",size:"sm",children:t==="ar"?"إصلاح صلاحيات الجدول":"Fix Table Permissions"}),e.jsx("div",{className:"text-xs text-gray-400 max-w-md text-center",children:t==="ar"?"يبدو أن هناك مشكلة في صلاحيات الجدول. اضغط لإصلاحها.":"There seems to be a permissions issue with the table. Click to fix it."})]})]}):e.jsx("div",{className:"space-y-4",children:_.map((s,l)=>{var N;return e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${E(s.action_type)}`,children:u(s.action_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ne,{variant:"outline",className:E(s.action_type),children:m(s.action_type)}),e.jsx("span",{className:"text-sm text-gray-500",children:h(s.created_at)})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:A(s)}),((N=s.action_details)==null?void 0:N.price)&&e.jsxs("div",{className:"text-xs text-gray-500",children:[t==="ar"?"السعر: ":"Price: ",s.action_details.price," ",s.action_details.currency||"EUR"]})]})]}),l<_.length-1&&e.jsx(oe,{className:"mt-4"})]},s.id)})})}),e.jsx("div",{className:"flex justify-end gap-2 pt-4",children:e.jsx(w,{variant:"outline",onClick:()=>i(!1),children:t==="ar"?"إغلاق":"Close"})})]})})};export{qe as A,Ke as S,be as f,De as u};
